<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Olog -Cart</title>
    <link rel="stylesheet" href="dist/main.css">
</head>

<body>
   <!-- Header Area Start -->
   <header class="header">
    <div class="header-bottom">
        <div class="container">
            <div class="d-none d-lg-block">
                <nav class="menu-area d-flex align-items-center">
                    <div class="logo">
                        <a href="index.html"><img src="dist/images/logo/logo.png" alt="logo" /></a>
                    </div>
                    <ul class="main-menu d-flex align-items-center">
                        <li><a class="active" href="index.html">Home</a></li>
                        <li><a href="why.html">Why Us</a></li>
                        <li><a href="shop.html">Products</a></li>
                    </ul>
                    <div class="menu-icon ml-auto">
                        <ul>
                            <li>
                                <a href="cart.html">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22">
                                        <g id="Icon" transform="translate(-1524 -89)">
                                            <ellipse id="Ellipse_2" data-name="Ellipse 2" cx="0.909" cy="0.952"
                                                rx="0.909" ry="0.952" transform="translate(1531.364 108.095)"
                                                fill="none" stroke="#1a2224" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" />
                                            <ellipse id="Ellipse_3" data-name="Ellipse 3" cx="0.909" cy="0.952"
                                                rx="0.909" ry="0.952" transform="translate(1541.364 108.095)"
                                                fill="none" stroke="#1a2224" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" />
                                            <path id="Path_3" data-name="Path 3"
                                                d="M1,1H4.636L7.073,13.752a1.84,1.84,0,0,0,1.818,1.533h8.836a1.84,1.84,0,0,0,1.818-1.533L21,5.762H5.545"
                                                transform="translate(1524 89)" fill="none" stroke="#1a2224"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                                        </g>
                                    </svg>
                                    <span class="cart">3</span>
                                </a>
                            </li>
                            <li>
                                <a href="account.html">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewBox="0 0 18 20">
                                        <g id="Account" transform="translate(1 1)">
                                            <path id="Path_86" data-name="Path 86"
                                                d="M20,21V19a4,4,0,0,0-4-4H8a4,4,0,0,0-4,4v2"
                                                transform="translate(-4 -3)" fill="none" stroke="#000"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                                            <circle id="Ellipse_9" data-name="Ellipse 9" cx="4" cy="4" r="4"
                                                transform="translate(4)" fill="#fff" stroke="#000"
                                                stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                                        </g>
                                    </svg>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</header>

<!-- Header Area End -->
    <!-- Header Area End -->

    <script>document.addEventListener('DOMContentLoaded', function () {
        updateCartCount(); // Header'daki ürün sayısını her sayfada güncelle
    });
    </script>

<main>
   <!-- Cart Section Start -->
<section class="cart-area">
    <div class="container" style="max-width: 1200px;">
        <div class="row">
            <!-- Left Column: Products -->
            <div class="col-lg-8" style="padding-top: 60px;">
                <div class="cart-items" id="cart-items">
                    <!-- Dinamik ürünler buraya eklenecek -->
                    <div class="cart-item d-flex justify-content-between align-items-center mb-3">
                        <div class="cart-item-details d-flex align-items-center">
                            <img src="dist/images/product-1.jpg" alt="Product" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div class="ml-3">
                                <h6>Product Name</h6>
                                <p class="text-muted">Category | Size: Medium</p>
                                <p class="text-muted">$50.00</p>
                            </div>
                        </div>
                        <div class="cart-item-actions d-flex align-items-center">
                            <input type="number" value="1" min="1" class="form-control" style="width: 60px; margin-right: 10px;">
                            <button class="btn btn-danger btn-sm">Remove</button>
                        </div>
                    </div>

                    <!-- Repeat this block for multiple items -->
                    <div class="cart-item d-flex justify-content-between align-items-center mb-3">
                        <div class="cart-item-details d-flex align-items-center">
                            <img src="dist/images/product-2.jpg" alt="Product" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div class="ml-3">
                                <h6>Another Product</h6>
                                <p class="text-muted">Category | Size: Large</p>
                                <p class="text-muted">$30.00</p>
                            </div>
                        </div>
                        <div class="cart-item-actions d-flex align-items-center">
                            <input type="number" value="1" min="1" class="form-control" style="width: 60px; margin-right: 10px;">
                            <button class="btn btn-danger btn-sm">Remove</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Coupon & Checkout -->
            <div class="col-lg-4">
                <!-- Coupon Section -->
                <div class="apply-coupon p-3 mb-3" style="border: 1px solid #ddd; border-radius: 8px;">
                    <h6>Apply Coupon</h6>
                    <form id="coupon-form">
                        <input 
                            type="text" 
                            id="coupon-code" 
                            class="form-control mb-2" 
                            placeholder="Enter Coupon Code"
                            required
                        >
                        <button 
                            id="apply-coupon-button" 
                            class="btn btn-primary btn-block" 
                            type="submit">
                            Apply Coupon
                        </button>
                    </form>
                </div>
                
                <!-- Order Summary -->
                <div class="order-summary p-3" style="border: 1px solid #ddd; border-radius: 8px;">
                    <h6>Order Summary</h6>
                    <div class="summary-item d-flex justify-content-between">
                        <span>Subtotal:</span>
                        <span id="subtotal">$80.00</span>
                    </div>
                    <hr>
                    <div class="summary-total d-flex justify-content-between font-weight-bold">
                        <span>Total:</span>
                        <span id="total">$80.00</span>
                    </div>
                    <a href="billing-information.html" class="btn btn-primary btn-block mt-3">Checkout Now</a>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Cart Section End -->

</main>


<script>
async function applyCoupon() {
    const couponCodeInput = document.querySelector('#coupon-code');
    const subtotalElement = document.querySelector('#subtotal');
    const totalElement = document.querySelector('#total');

    const couponCode = couponCodeInput.value.trim(); // Trim to remove extra spaces
    const subtotal = parseFloat(subtotalElement.innerText.replace('$', ''));

    if (!couponCode) {
        alert("Please enter a coupon code.");
        return;
    }

    try {
        const response = await fetch('http://backend:5001/api/apply-coupon', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ couponCode }),
        });

        if (!response.ok) {
            throw new Error(`HTTP Error: ${response.status}`);
        }

        const result = await response.json();

        if (result.success) {
            const discountRate = result.discount; // Backend'den dönen indirim oranı
            const discountAmount = (subtotal * discountRate) / 100;
            const total = subtotal - discountAmount;

            totalElement.innerText = `$${total.toFixed(2)}`;
            alert(`Coupon applied! You saved ${discountRate}%.`);
        } else {
            alert(result.message || "Invalid coupon code.");
        }
    } catch (error) {
        console.error("An error occurred:", error);
        alert("Something went wrong while applying the coupon. Please try again.");
    }
}

document.querySelector('#coupon-form').addEventListener('submit', function (event) {
    event.preventDefault(); // Formun submit işlemini engeller
    applyCoupon();
});

</script>

    
    

    <style>
    .cart-item {
        background: #fff;
    }
    
    .cart-item-actions input[type="number"] {
        border: 1px solid #ddd;
        border-radius: 4px;
        height: 30px;
    }
    .summary-item {
        padding: 5px 0;
    }   
    .cart-items {
    margin-top: 40px; /* Ürünlerin başlangıcına boşluk */
}

.apply-coupon, .order-summary {
    margin-top: 0; /* Sağ sütunun hizalanması için ayarlandı */
}

    
</style>  
  <!-- Footer -->
 <!-- Footer -->
 <footer>
    <div class="container">
        <div class="row align-items-center newsletter-area">
            <div class="col-lg-5">
                <div class="newsletter-area-text">
                    <h5 class="text-white">Subscribe to get notification.</h5>
                    <p>
                        Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                    </p>
                </div>
            </div>
            <div class="col-lg-6 offset-lg-1">
                <div class="newsletter-area-button">
                    <form action="#">
                        <div class="form">
                            <input type="email" name="email" id="mail" placeholder="Enter your email address"
                                class="form-control">
                            <button class="btn bg-secondary border text-capitalize">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
      
        <div class="footer-links d-flex justify-content-center mt-4">
            <ul class="list-inline">
                <li class="list-inline-item"><a href="#">Terms of Service</a></li>
                <li class="list-inline-item"><a href="#">Privacy Policy</a></li>
                <li class="list-inline-item"><a href="#">Help &amp; Support</a></li>
            </ul>
        </div>


        <div class="row">
            <div class="col-lg-12">
                <div class="copyright d-flex justify-content-between align-items-center">
                    <div class="copyright-text order-2 order-lg-1">
                        <p>&copy; 2020. Design and Developed by <a href="#">Pass</a></p>
                    </div>
                   
                    <div class="copyright-links order-1 order-lg-2">
                        <a href="#" class="ml-0"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- Footer -->
<!-- Footer -->



    <script src="src/js/jquery.min.js"></script>
    <script src="src/js/bootstrap.min.js"></script>
    <script src="src/scss/vendors/plugin/js/jquery.nice-select.min.js"></script>
    <script src="dist/main.js"></script>
    <script src="src/js/cart.js"></script>
    <script>
        function openNav() {

            document.getElementById("mySidenav").style.width = "350px";
            $('#overlayy').addClass("active");
        }

        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
            $('#overlayy').removeClass("active");
        }
    </script>
</body>
